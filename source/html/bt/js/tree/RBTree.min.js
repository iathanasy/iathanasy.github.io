Ext.define("MJ.RBTree",{extend:"MJ.BBST",statics:{RED:false,BLACK:true},config:{showNull:false},constructor:function(a){this.initConfig(a);this.callParent(arguments)},createNode:function(a,b){return new MJ.RBTree.Node({element:a,parent:b})},afterAdd_:function(c){var b=c.parent;if(b==null){this._black(c);return}if(this._isBlack(b)){return}var d=this._red(b.parent);var a=b.sibling();if(this._isRed(a)){this._black(b);this._black(a);this.afterAdd_(d);return}if(b.isLeftChild()){if(c.isLeftChild()){this._black(b)}else{this._black(c);this.rotateLeft_(b)}this.rotateRight_(d)}else{if(c.isLeftChild()){this._black(c);this.rotateRight_(b)}else{this._black(b)}this.rotateLeft_(d)}},afterRemove_:function(c){if(this._isRed(c)){this._black(c);return}var b=c.parent;if(!b){return}var d=c.isLeftChild()||!b.left;var a=d?b.right:b.left;if(d){if(this._isRed(a)){this._black(a);this._red(b);this.rotateLeft_(b);a=b.right}if(this._isBlack(a.left)&&this._isBlack(a.right)){var e=this._isBlack(b);this._black(b);this._red(a);if(e){this.afterRemove_(b,b.isLeftChild(),null)}}else{if(this._isBlack(a.right)){this.rotateRight_(a);a=b.right}this._color(a,this._colorOf(b));this._black(b);this._black(a.right);this.rotateLeft_(b)}}else{if(this._isRed(a)){this._black(a);this._red(b);this.rotateRight_(b);a=b.left}if(this._isBlack(a.left)&&this._isBlack(a.right)){var e=this._isBlack(b);this._black(b);this._red(a);if(e){this.afterRemove_(b,b.isLeftChild(),null)}}else{if(this._isBlack(a.left)){this.rotateLeft_(a);a=b.left}this._color(a,this._colorOf(b));this._black(b);this._black(a.left);this.rotateRight_(b)}}},_isBlack:function(a){return !a||a.color===MJ.RBTree.BLACK},_isRed:function(a){return a&&a.color===MJ.RBTree.RED},_colorOf:function(a){return !a?MJ.RBTree.BLACK:a.color},_color:function(b,a){if(b){b.color=a}return b},_black:function(a){if(a){a.color=MJ.RBTree.BLACK}return a},_red:function(a){if(a){a.color=MJ.RBTree.RED}return a}});Ext.define("MJ.RBTree.Node",{config:{color:MJ.RBTree.RED},extend:"MJ.BinaryTree.Node",constructor:function(a){this.callParent(arguments);this.initConfig(a)}});